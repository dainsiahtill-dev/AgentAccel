# Full Plan: hp_20260214T050208Z_62c021
Mode: S2 Standard | Approval: Explicit

## Contract Snapshot
Goal: Add an MCP tool that performs one-shot context narrowing for implementation tasks to reduce token waste by returning affected files, minimal snippets, and impacted test scope in a single call.
Acceptance Criteria:
- 1) Add a new MCP tool in accel/mcp_server.py for one-shot planning output.
2) Reuse existing context/index logic and return affected_files, minimal_snippets, impacted_tests and verify commands in one response.
3) Bound snippet output with budget and avoid full-file reads.
4) Add/adjust tests for deterministic response shape and core behavior.
5) Run targeted test suite and report evidence.

## Scope
- `accel/mcp_server.py,tests/test_smoke_mcp.py,README.md`

## Budget (Scope Budget)
- Touched Files: <= 3
- Changed LOC: <= 220
- Dependencies: No new external dependencies; reuse existing context compiler, index cache, and verify plan generation.

## Approach
- Add a new MCP tool (`accel_plan_and_gate`) that composes existing `_tool_context` output into a compact one-shot response: affected_files from ranked top_files, minimal_snippets from bounded snippets, and impacted_tests from verify_plan. Keep it synchronous and deterministic, with optional include_pack passthrough and small governance metadata hints. Add smoke tests for direct helper behavior and ensure tool registration path remains healthy.

## Rollback
- Snapshot + rollback.sh
