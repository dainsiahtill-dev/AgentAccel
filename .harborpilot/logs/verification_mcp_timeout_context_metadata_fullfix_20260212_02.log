VERIFICATION_START mcp_timeout_context_metadata_fullfix_20260212_02 2026-02-12T01:28:32.0587578Z
ENV branch=main commit=624d60e34d73f54f5a3718a7061c552618d6299c python=3.14.2 (tags/v3.14.2:df79316, Dec  5 2025, 17:18:21) [MSC v.1944 64 bit (AMD64)]
CMD[full_pytest] $env:PYTHONPATH="X:/MCPs/agent-accel"; $env:PYTHONDONTWRITEBYTECODE="1"; pytest -q
EXIT[full_pytest] 2
OUTPUT[full_pytest]

=================================== ERRORS ====================================
______________________ ERROR collecting test_tool_api.py ______________________
test_tool_api.py:31: in <module>
    print(f"accel_verify_start type: {type(ms.accel_verify_start)}")
                                           ^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'accel.mcp_server' has no attribute 'accel_verify_start'
------------------------------- Captured stdout -------------------------------
Testing accel_verify_start...
Tool function signature: (name_or_fn: 'str | AnyFunction | None' = None, *, name: 'str | None' = 'accel_verify_start', title: 'str | None' = None, description: 'str | None' = None, icons: 'list[mcp.types.Icon] | None' = None, tags: 'set[str] | None' = None, output_schema: 'dict[str, Any] | NotSetT | None' = Ellipsis, annotations: 'ToolAnnotations | dict[str, Any] | None' = None, exclude_args: 'list[str] | None' = None, meta: 'dict[str, Any] | None' = None, enabled: 'bool | None' = None, task: 'bool | TaskConfig | None' = None) -> 'Callable[[AnyFunction], FunctionTool] | FunctionTool'
Positional args error: FastMCP.tool() takes from 1 to 2 positional arguments but 5 positional arguments (and 11 keyword-only arguments) were given
Kwargs error: FastMCP.tool() got an unexpected keyword argument 'project'

Checking original tool function...
============================== warnings summary ===============================
test_async_verify.py:8
  X:\MCPs\agent-accel\test_async_verify.py:8: PytestCollectionWarning: cannot collect test class 'TestCallback' because it has a __init__ constructor (from: test_async_verify.py)
    class TestCallback(VerifyProgressCallback):

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ===========================
ERROR test_tool_api.py - AttributeError: module 'accel.mcp_server' has no att...
!!!!!!!!!!!!!!!!!!! Interrupted: 1 error during collection !!!!!!!!!!!!!!!!!!!!
1 warning, 1 error in 2.09s
CMD[full_ruff] python -m ruff check .
EXIT[full_ruff] 1
OUTPUT[full_ruff]
F821 Undefined name `MAX_FILE_SIZE_BYTES`
  --> accel\indexers\deps.py:75:24
   |
73 |     try:
74 |         file_size = file_path.stat().st_size
75 |         if file_size > MAX_FILE_SIZE_BYTES:
   |                        ^^^^^^^^^^^^^^^^^^^
76 |             return [{
77 |                 "type": "error",
   |

F821 Undefined name `MAX_FILE_SIZE_BYTES`
  --> accel\indexers\references.py:68:24
   |
66 |     try:
67 |         file_size = file_path.stat().st_size
68 |         if file_size > MAX_FILE_SIZE_BYTES:
   |                        ^^^^^^^^^^^^^^^^^^^
69 |             return [{
70 |                 "type": "error",
   |

F821 Undefined name `MAX_FILE_SIZE_BYTES`
  --> accel\indexers\symbols.py:86:24
   |
84 |     try:
85 |         file_size = file_path.stat().st_size
86 |         if file_size > MAX_FILE_SIZE_BYTES:
   |                        ^^^^^^^^^^^^^^^^^^^
87 |             return [{
88 |                 "type": "error",
   |

F401 [*] `time` imported but unused
 --> test_async_verify.py:1:8
  |
1 | import time
  |        ^^^^
2 | import threading
3 | from pathlib import Path
  |
help: Remove unused import: `time`

F401 [*] `threading` imported but unused
 --> test_async_verify.py:2:8
  |
1 | import time
2 | import threading
  |        ^^^^^^^^^
3 | from pathlib import Path
4 | from accel.verify.job_manager import JobManager, JobState
  |
help: Remove unused import: `threading`

F401 [*] `pathlib.Path` imported but unused
 --> test_async_verify.py:3:21
  |
1 | import time
2 | import threading
3 | from pathlib import Path
  |                     ^^^^
4 | from accel.verify.job_manager import JobManager, JobState
5 | from accel.verify.callbacks import VerifyProgressCallback, VerifyStage
  |
help: Remove unused import: `pathlib.Path`

F401 [*] `accel.config.resolve_effective_config` imported but unused
 --> test_async_verify.py:6:26
  |
4 | from accel.verify.job_manager import JobManager, JobState
5 | from accel.verify.callbacks import VerifyProgressCallback, VerifyStage
6 | from accel.config import resolve_effective_config
  |                          ^^^^^^^^^^^^^^^^^^^^^^^^
7 |
8 | class TestCallback(VerifyProgressCallback):
  |
help: Remove unused import: `accel.config.resolve_effective_config`

F541 [*] f-string without any placeholders
   --> test_async_verify.py:107:7
    |
105 | for field in required_fields:
106 |     assert field in status, f"Status should contain '{field}'"
107 | print(f"   Status contains all required fields")
    |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
108 | print(f"   Sample status: {status}")
109 | print("   OK: Job status format is correct")
    |
help: Remove extraneous `f` prefix

F401 [*] `time` imported but unused
 --> test_tool_api.py:1:8
  |
1 | import time
  |        ^^^^
2 | import inspect
3 | from accel.mcp_server import create_server
  |
help: Remove unused import: `time`

E402 Module level import not at top of file
  --> test_tool_api.py:27:1
   |
25 | # Check the original tool function
26 | print("\nChecking original tool function...")
27 | from accel.mcp_server import create_server
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
28 | import accel.mcp_server as ms
   |

E402 Module level import not at top of file
  --> test_tool_api.py:28:1
   |
26 | print("\nChecking original tool function...")
27 | from accel.mcp_server import create_server
28 | import accel.mcp_server as ms
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
29 |
30 | # Get the actual function
   |

F401 [*] `threading` imported but unused
 --> test_verify_blocking.py:2:8
  |
1 | import time
2 | import threading
  |        ^^^^^^^^^
3 | from concurrent.futures import ThreadPoolExecutor, TimeoutError as FuturesTimeoutError
  |
help: Remove unused import: `threading`

Found 12 errors.
[*] 7 fixable with the `--fix` option.
CMD[full_mypy] $env:PYTHONPATH="X:/MCPs/agent-accel"; $env:PYTHONDONTWRITEBYTECODE="1"; python -m mypy .
EXIT[full_mypy] 1
OUTPUT[full_mypy]
accel\verify\runners.py:88: error: Module has no attribute "getpgid"; maybe "getpid" or "getppid"?  [attr-defined]
accel\verify\runners.py:91: error: Module has no attribute "getpgid"; maybe "getpid" or "getppid"?  [attr-defined]
accel\verify\runners.py:91: error: Module has no attribute "SIGKILL"; maybe "SIGILL"?  [attr-defined]
accel\verify\runners.py:125: error: Module has no attribute "setsid"  [attr-defined]
accel\indexers\symbols.py:86: error: Name "MAX_FILE_SIZE_BYTES" is not defined  [name-defined]
accel\indexers\references.py:68: error: Name "MAX_FILE_SIZE_BYTES" is not defined  [name-defined]
accel\indexers\deps.py:75: error: Name "MAX_FILE_SIZE_BYTES" is not defined  [name-defined]
accel\verify\job_manager.py:171: error: Cannot determine type of "_initialized"  [has-type]
accel\verify\job_manager.py:175: error: Cannot determine type of "_initialized"  [has-type]
accel\storage\state_db.py:20: error: Missing return statement  [return]
test_async_verify.py:21: error: Signature of "on_command_complete" incompatible with supertype "accel.verify.callbacks.VerifyProgressCallback"  [override]
test_async_verify.py:21: note:      Superclass:
test_async_verify.py:21: note:          def on_command_complete(self, job_id: str, command: str, exit_code: int, duration: float, *, completed: int | None = ..., total: int | None = ..., stdout_tail: str = ..., stderr_tail: str = ...) -> None
test_async_verify.py:21: note:      Subclass:
test_async_verify.py:21: note:          def on_command_complete(self, job_id: str, command: str, exit_code: int, duration: float) -> None
test_async_verify.py:27: error: Signature of "on_heartbeat" incompatible with supertype "accel.verify.callbacks.VerifyProgressCallback"  [override]
test_async_verify.py:27: note:      Superclass:
test_async_verify.py:27: note:          def on_heartbeat(self, job_id: str, elapsed_sec: float, eta_sec: float | None, state: str, *, current_command: str = ..., command_elapsed_sec: float | None = ..., command_timeout_sec: float | None = ..., command_progress_pct: float | None = ...) -> None
test_async_verify.py:27: note:      Subclass:
test_async_verify.py:27: note:          def on_heartbeat(self, job_id: str, elapsed_sec: float, eta_sec: float | None, state: str) -> None
test_tool_api.py:13: error: Too many arguments  [call-arg]
test_tool_api.py:13: error: Argument 1 has incompatible type "str"; expected "Callable[..., Any]"  [arg-type]
test_tool_api.py:20: error: Unexpected keyword argument "project"  [call-arg]
test_tool_api.py:31: error: Module has no attribute "accel_verify_start"  [attr-defined]
test_tool_api.py:32: error: Module has no attribute "accel_verify_start"  [attr-defined]
tests\unit\test_mcp_server.py:717: error: "Tool" has no attribute "fn"  [attr-defined]
tests\unit\test_mcp_server.py:718: error: "Tool" has no attribute "fn"  [attr-defined]
tests\unit\test_mcp_server.py:719: error: "Tool" has no attribute "fn"  [attr-defined]
tests\unit\test_mcp_server.py:757: error: "Tool" has no attribute "fn"  [attr-defined]
tests\unit\test_mcp_server.py:785: error: "Tool" has no attribute "fn"  [attr-defined]
tests\unit\test_mcp_server.py:868: error: "Tool" has no attribute "fn"  [attr-defined]
tests\unit\test_mcp_server.py:869: error: "Tool" has no attribute "fn"  [attr-defined]
tests\unit\test_mcp_server.py:870: error: "Tool" has no attribute "fn"  [attr-defined]
tests\unit\test_mcp_server.py:935: error: "Tool" has no attribute "fn"  [attr-defined]
tests\unit\test_mcp_server.py:936: error: "Tool" has no attribute "fn"  [attr-defined]
tests\unit\test_mcp_server.py:937: error: "Tool" has no attribute "fn"  [attr-defined]
tests\unit\test_mcp_server.py:1022: error: "Tool" has no attribute "fn"  [attr-defined]
tests\unit\test_mcp_server.py:1023: error: "Tool" has no attribute "fn"  [attr-defined]
tests\unit\test_mcp_server.py:1024: error: "Tool" has no attribute "fn"  [attr-defined]
tests\unit\test_mcp_server.py:1025: error: "Tool" has no attribute "fn"  [attr-defined]
tests\unit\test_mcp_server.py:1118: error: "Tool" has no attribute "fn"  [attr-defined]
tests\unit\test_mcp_server.py:1119: error: "Tool" has no attribute "fn"  [attr-defined]
tests\unit\test_mcp_server.py:1184: error: "Tool" has no attribute "fn"  [attr-defined]
tests\unit\test_mcp_server.py:1185: error: "Tool" has no attribute "fn"  [attr-defined]
tests\unit\test_mcp_server.py:1242: error: "Tool" has no attribute "fn"  [attr-defined]
tests\unit\test_mcp_server.py:1243: error: "Tool" has no attribute "fn"  [attr-defined]
tests\unit\test_mcp_server.py:1305: error: "Tool" has no attribute "fn"  [attr-defined]
tests\unit\test_mcp_server.py:1358: error: "Tool" has no attribute "fn"  [attr-defined]
Found 40 errors in 9 files (checked 43 source files)
CMD[scope_pytest] $env:PYTHONPATH="X:/MCPs/agent-accel"; $env:PYTHONDONTWRITEBYTECODE="1"; pytest -q tests/unit/test_mcp_server.py
EXIT[scope_pytest] 0
OUTPUT[scope_pytest]
............................                                             [100%]
28 passed in 6.21s
CMD[scope_ruff] python -m ruff check accel/mcp_server.py accel/config.py tests/unit/test_mcp_server.py
EXIT[scope_ruff] 0
OUTPUT[scope_ruff]
All checks passed!
DEGRADE_REASON: baseline repository gate failures (existing test_tool_api collection issue + existing lint/type debt)
RISK: full gate remains non-green; changes validated with touched-scope gates only
BACKFILL_PLAN: owner=user commands="fix baseline gates then rerun pytest -q && ruff check . && mypy ." deadline_utc=2026-02-13T00:00:00Z
VERIFICATION_END mcp_timeout_context_metadata_fullfix_20260212_02 2026-02-12T01:28:46.6831656Z
